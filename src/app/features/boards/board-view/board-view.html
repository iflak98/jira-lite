<app-header></app-header>

<div class="board-container" *ngIf="selectedBoard()">
  <div class="board-header">
    <button class="back-btn" (click)="goBack()">‚Üê Back to Boards</button>
    <h2>{{ selectedBoard()?.title }}</h2>
  </div>

  <div class="lists" cdkDropListGroup>
    <div
      class="list"
      *ngFor="let list of lists(); trackBy: trackByList"
      cdkDropList
      [cdkDropListData]="list.cards"
      (cdkDropListDropped)="drop($event, list)"
    >
      <h3>{{ list.title }}</h3>

      <div class="cards">
        <ng-container *ngFor="let card of getVisibleCards(list); trackBy: trackByCard">
          <div
            class="card"
            cdkDrag
            *ngIf="canDragCard(card)"
            [cdkDragData]="card"
            [ngClass]="{
              'high-priority': card.priority === 'HIGH',
              'medium-priority': card.priority === 'MEDIUM',
              'low-priority': card.priority === 'LOW'
            }"
            (click)="openCardDetails(card)"
          >
            <strong>{{ card.title }}</strong>
            <small>{{ card.priority }}</small>
            <p>{{ card.createdAt  | date}}</p>
          </div>

          <div
            class="card disabled"
            *ngIf="!canDragCard(card)"
            [ngClass]="{
              'high-priority': card.priority === 'HIGH',
              'medium-priority': card.priority === 'MEDIUM',
              'low-priority': card.priority === 'LOW'
            }"
          >
            <strong>{{ card.title }}</strong>
            <small>{{ card.priority }}</small>
            <p>{{ card.createdAt | date}}</p>
          </div>
        </ng-container>
      </div>
    </div>
  </div>
</div>

<div *ngIf="!selectedBoard()">
  <p>No board selected.</p>
</div>
